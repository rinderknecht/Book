%%-*-latex-*-

\documentclass[11pt]{article}

\usepackage{pst-tree,pst-eps}

\input{ocaml_syntax}

\begin{document}

\TeXtoEPS
\pstree[nodesep=2pt,levelsep=19pt]{\TR[name=outer-fun]{\cst{Fun}}}{
  \TR{\str{y}}
  \pstree{\TR{\cst{BinOp}}}{
    \TR{\cst{Add}}
    \pstree{\TR{\cst{Var}}}{
      \TR{\framebox{\str{x}}}
    }
    \pstree{\TR{\cst{App}}}{
      \pstree{\TR[name=inner-fun]{\cst{Fun}}}{
        \TR{\str{x}}
        \pstree{\TR[name=inner-var]{\cst{Var}}}{
          \TR{\str{x}}
        }
      }
      \pstree{\TR[name=outer-var]{\cst{Var}}}{
        \TR{\str{y}}
      }
    }
  }
}
\nccurve[linestyle=dotted,nodesepA=1pt,nodesepB=1pt,angleA=45]{->}{inner-var}{inner-fun}
\ncarc[linestyle=dotted,nodesepA=1pt,nodesepB=1pt,arcangle=-40]{->}{outer-var}{outer-fun}
\endTeXtoEPS

\end{document}
